{
  "{CCF8F190-92DA-4BC5-9112-035B85A6600D}": {
    "source": "{\n  \"name\": \"webdriver\",\n  \"version\": \"0.7.1\",\n  \"description\": \"Operate the browser with wes\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/wachaon/webdriver.git\"\n  },\n  \"keywords\": [\n    \"webdriver\"\n  ],\n  \"author\": \"wachaon\",\n  \"license\": \"MIT\",\n  \"bugs\": {\n    \"url\": \"https://github.com/wachaon/webdriver/issues\"\n  },\n  \"homepage\": \"https://github.com/wachaon/webdriver#readme\"\n}",
    "mapping": {},
    "path": "{webdriver}/package.json"
  },
  "{88348EC5-DA78-47CF-95EA-8C9D2AC68991}": {
    "source": "const WShell = require('WScript.Shell')\r\nconst { eraseInLine, cursorHrAbs, color } = require('ansi')\r\nconst { has } = require('argv')\r\nconst { moveFileSync, deleteFileSync, deletedirSync, existsFileSync, existsdirSync, download } = require('filesystem')\r\nconst { resolve, WorkingDirectory, toPosixSep } = require('pathname')\r\nconst { unzip } = require('zip')\r\nconst isCLI = require('isCLI')\r\n\r\nconst GET = 'GET'\r\nconst POST = 'POST'\r\nconst DELETE = 'DELETE'\r\nconst BOL = cursorHrAbs(1) // beginning of line\r\nconst EIL = eraseInLine(0) // erase in line\r\nconst ELEMENT_ID = 'element-6066-11e4-a52e-4f735466cecf'\r\nconst State = ['UNINITIALIZED', 'LOADING', 'LOADED', 'INTERACTIVE', 'COMPLETED']\r\nconst spiner = progress(['|', '/', '-', '\\\\'])\r\nconst orange = color('#FFA500')\r\nconst EDGE = 'msedgedriver.exe'\r\nconst CHROME = 'chromedriver.exe'\r\nconst GECKO = 'geckodriver.exe'\r\n\r\nclass Window {\r\n    constructor(port, spec = EDGE, parameter = { capabilities: {} }) {\r\n        const IServerXMLHTTPRequest2 = require('MSXML2.ServerXMLHTTP')\r\n\r\n        port = port || findUnusedPort(9515)\r\n        spec = spec.toUpperCase() === 'CHROME' ? CHROME :\r\n            spec.toUpperCase() === 'GECKO' ? GECKO :\r\n                spec.toUpperCase() === 'EDGE' ? EDGE : spec\r\n        const driver = WShell.Exec(`${spec} --port=${port} --silent`)\r\n\r\n        var { value } = request(\r\n            IServerXMLHTTPRequest2,\r\n            POST,\r\n            `http://localhost:${port}/session`,\r\n            parameter,\r\n            'Initialize Session'\r\n        )\r\n        const { sessionId } = value\r\n\r\n\r\n        this.port = port\r\n        this.driver = driver\r\n        this.sessionId = sessionId\r\n        this.IServerXMLHTTPRequest2 = IServerXMLHTTPRequest2\r\n\r\n        const handle = request(\r\n            this.IServerXMLHTTPRequest2,\r\n            GET,\r\n            `http://localhost:${this.port}/session/${this.sessionId}/window`,\r\n            null,\r\n            'Get Handle'\r\n        )\r\n        this.handle = handle ? handle.value : null\r\n\r\n        this.document = new Document(this)\r\n    }\r\n    rect(prop) {\r\n        request(\r\n            this.IServerXMLHTTPRequest2,\r\n            POST,\r\n            `http://localhost:${this.port}/session/${this.sessionId}/window/rect`,\r\n            prop,\r\n            'Set Window Rect'\r\n        )\r\n    }\r\n    navigate(url) {\r\n        request(\r\n            this.IServerXMLHTTPRequest2,\r\n            POST,\r\n            `http://localhost:${this.port}/session/${this.sessionId}/url`,\r\n            {\r\n                url: url\r\n            },\r\n            'Navegate URL'\r\n        )\r\n    }\r\n    back() {\r\n        request(\r\n            this.IServerXMLHTTPRequest2,\r\n            POST,\r\n            `http://localhost:${this.port}/session/${this.sessionId}/back`,\r\n            {},\r\n            'Back History'\r\n        )\r\n    }\r\n    forward() {\r\n        request(\r\n            this.IServerXMLHTTPRequest2,\r\n            POST,\r\n            `http://localhost:${this.port}/session/${this.sessionId}/forward`,\r\n            {},\r\n            'Forward History'\r\n        )\r\n    }\r\n    getURL() {\r\n        const res = request(\r\n            this.IServerXMLHTTPRequest2,\r\n            GET,\r\n            `http://localhost:${this.port}/session/${this.sessionId}/url`,\r\n            null,\r\n            'Get URL'\r\n        )\r\n        return res ? res.value : null\r\n    }\r\n    getStatus() {\r\n        const res = request(\r\n            this.IServerXMLHTTPRequest2,\r\n            GET,\r\n            `http://localhost:${this.port}/status`,\r\n            null,\r\n            'Get Status'\r\n        )\r\n        if (res) return res.value\r\n    }\r\n    getHandle() {\r\n        const res = request(\r\n            this.IServerXMLHTTPRequest2,\r\n            GET,\r\n            `http://localhost:${this.port}/session/${this.sessionId}/window`,\r\n            null,\r\n            'Get Handle'\r\n        )\r\n        return res ? res.value : null\r\n    }\r\n    getHandles() {\r\n        const res = request(\r\n            this.IServerXMLHTTPRequest2,\r\n            GET,\r\n            `http://localhost:${this.port}/session/${this.sessionId}/window/handles`,\r\n            null,\r\n            'Get Handles'\r\n        )\r\n        return res ? res.value : null\r\n    }\r\n    switchTo(windowHandle) {\r\n        const res = request(\r\n            this.IServerXMLHTTPRequest2,\r\n            POST,\r\n            `http://localhost:${this.port}/session/${this.sessionId}/window`,\r\n            {\r\n                handle: windowHandle\r\n            },\r\n            'Switch Window'\r\n        )\r\n        if (res) {\r\n            this.handle = windowHandle\r\n            return res.value\r\n        } return null\r\n    }\r\n    move(handle) {\r\n        const currHandle = this.getHandle()\r\n        if (!handle) handle = this.getHandles().filter((hnd) => (hnd === currHandle ? false : true))[0]\r\n        this.switchTo(handle)\r\n        const url = this.getURL()\r\n        this.switchTo(currHandle)\r\n        this.navigate(url)\r\n        this.switchTo(handle)\r\n        this.close()\r\n        this.switchTo(currHandle)\r\n    }\r\n    newWindow() {\r\n        const res = request(\r\n            this.IServerXMLHTTPRequest2,\r\n            POST,\r\n            `http://localhost:${this.port}/session/${this.sessionId}/window/new`,\r\n            {},\r\n            'New Window'\r\n        )\r\n        return res ? res.value : null\r\n    }\r\n    close(message) {\r\n        request(\r\n            this.IServerXMLHTTPRequest2,\r\n            DELETE,\r\n            `http://localhost:${this.port}/session/${this.sessionId}/window`,\r\n            null,\r\n            'Close Window'\r\n        )\r\n        if (message != null) console.log(message)\r\n    }\r\n    delete(message) {\r\n        request(\r\n            this.IServerXMLHTTPRequest2,\r\n            DELETE,\r\n            `http://localhost:${this.port}/session/${this.sessionId}`,\r\n            null,\r\n            'Delete Session'\r\n        )\r\n        this.driver.Terminate()\r\n        if (message != null) console.log(message)\r\n    }\r\n    quit(message) {\r\n        this.close()\r\n        this.delete(message)\r\n    }\r\n}\r\n\r\nclass Document {\r\n    constructor(window) {\r\n        this.parentWindow = window\r\n    }\r\n    querySelectorAll(selector) {\r\n        const window = this.parentWindow\r\n        const res = request(\r\n            window.IServerXMLHTTPRequest2,\r\n            POST,\r\n            `http://localhost:${window.port}/session/${window.sessionId}/elements`,\r\n            {\r\n                using: 'css selector',\r\n                value: selector\r\n            },\r\n            'Select Elements'\r\n        )\r\n        const elms = res != null ? res.value.map((val) => new Element(this, val[ELEMENT_ID])) : null\r\n        return elms\r\n    }\r\n    xpath(path) {\r\n        const window = this.parentWindow\r\n        const res = request(\r\n            window.IServerXMLHTTPRequest2,\r\n            POST,\r\n            `http://localhost:${window.port}/session/${window.sessionId}/elements`,\r\n            {\r\n                using: 'xpath',\r\n                value: path\r\n            },\r\n            'Select Elements'\r\n        )\r\n        const elms = res != null ? res.value.map((val) => new Element(this, val[ELEMENT_ID])) : null\r\n        return elms\r\n    }\r\n    getTitle() {\r\n        const window = this.parentWindow\r\n        return request(\r\n            window.IServerXMLHTTPRequest2,\r\n            GET,\r\n            `http://localhost:${window.port}/session/${window.sessionId}/title`\r\n        )\r\n    }\r\n    getSource() {\r\n        const window = this.parentWindow\r\n        const res = request(\r\n            window.IServerXMLHTTPRequest2,\r\n            GET,\r\n            `http://localhost:${window.port}/session/${window.sessionId}/source`,\r\n            {},\r\n            'Get Source'\r\n        )\r\n        return res ? res.value : null\r\n    }\r\n    executeScript(script = function () { }, args = []) {\r\n        const code = `return (${String(script)})(...arguments)`\r\n        const window = this.parentWindow\r\n        const res = request(\r\n            window.IServerXMLHTTPRequest2,\r\n            POST,\r\n            `http://localhost:${window.port}/session/${window.sessionId}/execute/sync`,\r\n            {\r\n                script: code,\r\n                args\r\n            },\r\n            'Execute Script'\r\n        )\r\n        return res ? res.value : null\r\n    }\r\n    takeScreenShot() {\r\n        const window = this.parentWindow\r\n        const { document } = window\r\n        const res = request(\r\n            window.IServerXMLHTTPRequest2,\r\n            GET,\r\n            `http://localhost:${window.port}/session/${window.sessionId}/screenshot`,\r\n            {},\r\n            'Take ScreenShot'\r\n        )\r\n        if (!res) return null\r\n        const message = document.executeScript(() => document.readyState)\r\n        console.log('take screen shot %O', message)\r\n\r\n        const DOMDocument = require('MSXML2.DOMDocument.3.0')\r\n        const IXMLDOMElement = DOMDocument.createElement('base64')\r\n        IXMLDOMElement.dataType = 'bin.base64'\r\n        IXMLDOMElement.text = res.value\r\n        return IXMLDOMElement.nodeTypedValue\r\n    }\r\n    getCookie(name) {\r\n        const window = this.parentWindow\r\n        const url = `http://localhost:${window.port}/session/${window.sessionId}/cookie` + (name != null ? '/' + name : '')\r\n        const res = request(window.IServerXMLHTTPRequest2, GET, url, null, 'Get Cookie')\r\n        return res ? res.value : null\r\n    }\r\n    addCookie(cookie) {\r\n        // cookie: {name: string, value: string, domain: string?, httpOnly: boolean?, path: string?, secure: boolean?}\r\n        const window = this.parentWindow\r\n        const res = request(\r\n            window.IServerXMLHTTPRequest2,\r\n            POST,\r\n            `http://localhost:${window.port}/session/${window.sessionId}/cookie`,\r\n            { cookie },\r\n            'Add Cookie'\r\n        )\r\n        return res ? res.value : null\r\n    }\r\n    deleteCookie(name) {\r\n        const window = this.parentWindow\r\n        request(\r\n            window.IServerXMLHTTPRequest2,\r\n            DELETE,\r\n            `http://localhost:${window.port}/session/${window.sessionId}/cookie/${name}`,\r\n            null,\r\n            'Delete Cookie'\r\n        )\r\n    }\r\n}\r\n\r\nclass Element {\r\n    constructor(document, elementId) {\r\n        this.parentDocument = document\r\n        this.elementId = elementId\r\n    }\r\n    querySelectorAll(selector) {\r\n        const document = this.parentDocument\r\n        const window = document.parentWindow\r\n        const res = request(\r\n            window.IServerXMLHTTPRequest2,\r\n            POST,\r\n            `http://localhost:${window.port}/session/${window.sessionId}/element/${this.elementId}/elements`,\r\n            {\r\n                using: 'css selector',\r\n                value: selector\r\n            },\r\n            'Select Elements'\r\n        )\r\n        const elms = res != null ? res.value.map((val) => new Element(document, val[ELEMENT_ID])) : null\r\n        return elms\r\n    }\r\n    getAttribute(attribute) {\r\n        const window = this.parentDocument.parentWindow\r\n        const res = request(\r\n            window.IServerXMLHTTPRequest2,\r\n            GET,\r\n            `http://localhost:${window.port}/session/${window.sessionId}/element/${this.elementId}/attribute/${attribute}`,\r\n            null,\r\n            'Get Attribute'\r\n        )\r\n        return res ? res.value : 'null'\r\n    }\r\n    getProperty(property) {\r\n        const window = this.parentDocument.parentWindow\r\n        const res = request(\r\n            window.IServerXMLHTTPRequest2,\r\n            GET,\r\n            `http://localhost:${window.port}/session/${window.sessionId}/element/${this.elementId}/property/${property}`,\r\n            null,\r\n            'Get Property'\r\n        )\r\n        return res ? res.value : 'null'\r\n    }\r\n    click() {\r\n        const window = this.parentDocument.parentWindow\r\n        request(\r\n            window.IServerXMLHTTPRequest2,\r\n            POST,\r\n            `http://localhost:${window.port}/session/${window.sessionId}/element/${this.elementId}/click`,\r\n            {},\r\n            'Click Element'\r\n        )\r\n    }\r\n    setValue(text) {\r\n        const window = this.parentDocument.parentWindow\r\n        request(\r\n            window.IServerXMLHTTPRequest2,\r\n            POST,\r\n            `http://localhost:${window.port}/session/${window.sessionId}/element/${this.elementId}/value`,\r\n            {\r\n                text\r\n            },\r\n            'Input Value'\r\n        )\r\n    }\r\n    clearValue(text) {\r\n        const window = this.parentDocument.parentWindow\r\n        request(\r\n            window.IServerXMLHTTPRequest2,\r\n            POST,\r\n            `http://localhost:${window.port}/session/${window.sessionId}/element/${this.elementId}/clear`,\r\n            {},\r\n            'Clear Value'\r\n        )\r\n    }\r\n    takeScreenShot() {\r\n        const document = this.parentDocument\r\n        const window = document.parentWindow\r\n        const res = request(\r\n            window.IServerXMLHTTPRequest2,\r\n            GET,\r\n            `http://localhost:${window.port}/session/${window.sessionId}/element/${this.elementId}/screenshot`,\r\n            {},\r\n            'Take ScreenShot'\r\n        )\r\n        if (!res) return null\r\n        const message = document.executeScript(() => document.readyState)\r\n        console.log('take screen shot %O', message)\r\n\r\n        const DOMDocument = require('MSXML2.DOMDocument.3.0')\r\n        const IXMLDOMElement = DOMDocument.createElement('base64')\r\n        IXMLDOMElement.dataType = 'bin.base64'\r\n        IXMLDOMElement.text = res.value\r\n        return IXMLDOMElement.nodeTypedValue\r\n    }\r\n}\r\n\r\n// util\r\nfunction getChromeVersion(spec = '\"C:\\\\Program Files (x86)\\\\Google\\\\Chrome\\\\Application\"') {\r\n    const [version] = WShell.exec(`cmd /C dir /B /O-N ${spec}`).StdOut.ReadAll().trim().split(/\\r?\\n/).slice(-1)\r\n    return version\r\n}\r\n\r\nfunction getChromeDriverVersion(spec = CHROME) {\r\n    return WShell.exec(`cmd /C ${spec} -v`)\r\n        .StdOut.ReadAll()\r\n        .trim()\r\n        .replace(/^ChromeDriver ([\\d\\.]+) .+/, '$1')\r\n}\r\n\r\nfunction getFireFoxVersion(spec = '\"C:\\\\Program Files\\\\Mozilla Firefox\\\\firefox.exe\"') {\r\n    return WShell.exec(`cmd /C ${spec} -v`).StdOut.ReadAll().trim().slice('Mozilla Firefox '.length)\r\n}\r\n\r\nfunction getFireFoxDriverVersion(spec = GECKO) {\r\n    return WShell.exec(`cmd /C ${spec} -V`)\r\n        .StdOut.ReadAll()\r\n        .trim()\r\n        .split(/\\r?\\n/)[0]\r\n        .replace(/^geckodriver ([\\d\\.]+) .+/, '$1')\r\n}\r\n\r\nfunction getEdgeVersion() {\r\n    return WShell.exec('powershell -Command Get-AppxPackage -Name Microsoft.MicrosoftEdge.* | foreach{$_.Version}')\r\n        .StdOut.ReadAll()\r\n        .trim()\r\n}\r\n\r\nfunction getEdgeDriverVersion(spec = EDGE) {\r\n    return WShell.exec(`cmd /C ${spec} -v`)\r\n        .StdOut.ReadAll()\r\n        .trim()\r\n        .replace(/^MSEdgeDriver ([\\d\\.]+) .+/, '$1')\r\n}\r\n\r\nfunction request(Server, method, url, parameter, processing, finished) {\r\n    Server.open(method, url, true)\r\n    if (method.toUpperCase() === POST) Server.setRequestHeader('Content-Type', 'application/json')\r\n    if (parameter != null) Server.send(JSON.stringify(parameter))\r\n    else Server.send()\r\n\r\n    let display\r\n    while (State[Server.readyState] != 'COMPLETED') {\r\n        if (processing !== null) console.weaklog(`${processing} ${spiner()} ${State[Server.readyState]}`)\r\n        WScript.Sleep(50)\r\n    }\r\n\r\n    if (Server.status != 200) {\r\n        throw new Error('Server Error: ' + Server.status + '\\nurl: ' + url + '\\nparameter: ' + parameter != null ? JSON.stringify(parameter, null, 2) : '{}')\r\n    }\r\n\r\n    console.weaklog(`${finished || ''}${display}`)\r\n\r\n    const res = Server.responseText\r\n    return JSON.parse(res)\r\n}\r\n\r\nfunction progress(indicator) {\r\n    let i = 0\r\n    return function increment() {\r\n        return indicator[i++ % indicator.length]\r\n    }\r\n}\r\n\r\nfunction findUnusedPort(port) {\r\n    const command = 'netstat -nao'\r\n    const netstat = WShell.Exec(command)\r\n    const res = netstat.StdOut.ReadAll()\r\n\r\n    while (true) {\r\n        port = port || parseInt(Math.random() * (65535 - 49152)) + 49152\r\n        const exp = new RegExp('(TCP|UDP)\\\\s+\\\\d{1,3}.\\\\d{1,3}.\\\\d{1,3}.\\\\d{1,3}:' + port + '\\\\s')\r\n        if (!exp.test(res)) break\r\n        port = null\r\n    }\r\n    return port\r\n}\r\n\r\nfunction getEdgeWebDriver() {\r\n    const version = getEdgeVersion()\r\n    const driver = getEdgeDriverVersion()\r\n    if (version === driver) return console.log('Both are installed with the correct version // => %O', version)\r\n\r\n    const filename = 'msedgedriver.exe'\r\n    const architecture = WShell.Environment('Process').Item('PROCESSOR_ARCHITECTURE') === 'x86' ? '32' : '64'\r\n\r\n    const url = `https://msedgedriver.azureedge.net/${version}/edgedriver_win${architecture}.zip`\r\n    const zipSpec = resolve(WorkingDirectory, `edgedriver_win${architecture}.zip`)\r\n    let dirSpec\r\n    let fileSpec = resolve(WorkingDirectory, filename)\r\n    try {\r\n        console.log(download(url, zipSpec))\r\n        console.log('unzip %O', (dirSpec = toPosixSep(unzip(zipSpec))))\r\n        if (existsFileSync(fileSpec)) deleteFileSync(fileSpec)\r\n        console.log(moveFileSync(resolve(dirSpec, filename), fileSpec))\r\n        console.log(deletedirSync(dirSpec))\r\n        console.log(deleteFileSync(zipSpec))\r\n        console.log('%SDownload of webdriver is complete. version: %S', orange, version)\r\n    } catch (error) {\r\n        console.log('%SFailed to download webdriver. version %S', orange, version)\r\n        throw error\r\n    } finally {\r\n        if (existsFileSync(zipSpec)) console.log(deleteFileSync(zipSpec))\r\n        if (existsdirSync(dirSpec)) console.log(deletedirSync(dirSpec))\r\n    }\r\n}\r\n\r\n// exports\r\nmodule.exports = {\r\n    Window,\r\n    Document,\r\n    Element,\r\n    request,\r\n    getEdgeWebDriver\r\n}\r\n\r\n// command line\r\nif (isCLI(__filename) && (has('d') || has('download'))) getEdgeWebDriver()\r\n",
    "mapping": {},
    "path": "{webdriver}/index.js"
  },
  "{13926F05-AAD2-4451-BD6F-D51492380C9C}": {
    "source": "MIT License\n\nCopyright (c) 2022 wachaon\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n",
    "mapping": {},
    "path": "{webdriver}/LICENSE"
  },
  "{FFFAF167-D006-4BCB-B84A-9347D110A5A1}": {
    "source": "# webdriver\n*Internet Explorer* が 2022/6/15 にサポート対象外になることにより、*windows script host* ではブラウザーの操作ができなくなると予想されます。\n\n今後ブラウザを操作するならば、*WebDriver* 経由で *Microsoft Edge based on Chromium* を操作が主流になります。\n\nこのモジュールは *WebDriver* の操作を支援します。\n\n## このモジュールのインストール\n\n```shell\nwes install @wachaon/webdriver --unsafe --bare\n```\n\n## *WebDriver* をインストールする\n\n*WebDriver* とブラウザは同じバージョンのものを使用する必要があります。\n\nこのモジュールをコマンドラインから `-d` もしくは `--download` オプションを指定して実行すると、ブラウザのバージョンとアーキテクチャーが同じ *WebDriver* をダウンロードし展開します。\n\n```shell\nwes webdriver --download\n```\n\n## usage\n\n下記スクリプトを実行して動作を確認してくだい。\n\n```javascript\nconst { Window } = require('webdriver')\nconst genGUID = require('genGUID')\n\nconst window = new Window()\nconst { document } = window\nwindow.rect({\n    x: 0,\n    y: 0,\n    width: 1280,\n    height: 600\n})\nwindow.navigate('https://www.google.co.jp')\n\nlet [input] = document.querySelectorAll('[name=\"q\"]')\ninput.setValue('selenium')\n\nlet [form] = document.querySelectorAll('form')\nlet [but] = form.querySelectorAll('input[name=\"btnK\"]')\nconsole.log('outerHTML // => %O', but.getProperty('outerHTML'))\nconsole.log('but class=%O', but.getAttribute('class'))\nbut.click()\n\nlet status = window.getStatus()\nconsole.log('Status: %O', status)\n\nconst name = genGUID()\ndocument.addCookie({\n    name: name,\n    value: genGUID()\n})\nconsole.log('getCookie(%O) // => %O', name, document.getCookie(name))\ndocument.deleteCookie(name)\n\nwindow.close('finished')\n```\n\n次は要素のスクリーンショットを取得する例になります。\n\n```javascript\nconst { Window } = require('webdriver')\nconst { writeFileSync } = require('filesystem')\nconst { resolve, WorkingDirectory } = require('pathname')\nconst genGUID = require('genGUID')\n\nconst window = new Window\nconst { document } = window\nwindow.rect({\n    x: 0,\n    y: 0,\n    width: 1280,\n    height: 600\n})\nwindow.navigate('https://www.yahoo.co.jp/')\n\nconst [elm] = document.querySelectorAll('#ContentWrapper > main > div:nth-child(2)')\nconst screen = elm.takeScreenShot()\n\nconst spec = resolve(WorkingDirectory, 'dev', genGUID() + '.png')\nconsole.log(writeFileSync(spec, screen))\n\nwindow.quit()\n```\n\n## `Window` クラス\n\nブラウザウインドウを操作するクラスになります。\n\n### `document`\n\n`Document` クラスの実体になります。\n\n### `constructor(port, spec)`\n\n`port` は *web driver* と通信するポートを指定します。既定値は `9515` ですが、`9515` ポートが使用済みの場合は使用可能なポートを探します。\n\n`spec` は *web driver* のファイルパスを指定します。既定値は `msedgedriver.exe` です。相対パスで指定する場合はカレントディレクトリからの相対パスにします。\n\n### `rect(prop)`\n\nウインドウの位置とサイズを変更します。\n`prop` は `{x, y, width, height}` を指定します。 `x`、`y` はウインドウ位置、`width`、`height` はウインドウサイズを指定します。\n\n### `navigate(url)`\n\n`url` に指定した *URL* に移動します。\n\n### `close(message)`\n\nブラウザの操作を終了します。\n`message` を指定した場合は、終了後にコンソールへ `message` を表示します。\n\n### `getURL()`\n\nブラウザの現在の *URL* を取得します。\n\n### `back()`\n\nブラウザの履歴から一つ戻ります。\n\n## `Document` クラス\n\n*HTML Document* から必要な要素を指定するクラスになります。\n\n簡素化を優先する為、メソッドは最低限の実装になります。\n\n### `querySelectorAll(selector)`\n\n*CSS Selector* で要素を検索します。対象がある場合の戻り値は要素の配列になります。\n\n### `getTitle()`\n\nタイトルを取得します。\n\n### `getSource()`\n\n*html* を取得します。\n\n### `executeScript(script, args)`\n\n`script` は関数オブジェクトを渡します。`script` は内部で `String(script)` で文字列に変換されるので、\n関数外部の参照はできません。\n\n```javascript\ndocument.executeScript(\n    function (text) {\n        document.getElementsByTagName('input')[0].value = text\n    },\n    [\"hello world\"]\n)\n```\n\n### `takeScreenShot()`\n\nスクリーンショットを撮ります。戻り値は `Byte[]` になります。\n\n### `getCookie(name)`\n\nクッキーを取得します。`name` があればその名前のクッキーを取得、`name` がなければ全てのクッキーを取得します。\n\n### `setCookie(object)`\n\nクッキーを設定します。\n\n### `deleteCookie(name)`\n\n`name` のクッキーを削除します。\n\n## `Element` クラス\n\n### `querySelectorAll(selector)`\n\n現在の要素の子孫ノードに対して *CSS Selector* で要素を検索します。対象がある場合の戻り値は要素の配列になります。\n\n### `getAttribute (attribute)`\n\n現在の要素の *element attribute* を取得します。\n\n### `getProperty (property)`\n\n現在の要素の *javascript property* を取得します。\n\n### `click()`\n\n現在の要素をクリックします。\n\n### `setValue(text)`\n\n現在の *input* などの要素に `text` を入力します。",
    "mapping": {},
    "path": "{webdriver}/README.md"
  }
}